<!DOCTYPE html>
<meta charset="UTF-8">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="pragma" content="no-cache">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style> body { margin: 0; } </style>
<title>castle</title>
<img src="./cbcity/texture.jpeg" alt="" id="dls" hidden>
<canvas id="openworldCanv" style="width:99vw;height:99vh"></canvas>
<!-- <img style="display: none" alt='none' src="https://ccgxk.com/getinfo/?info=house"> -->
<script src="../src/cannon/cannon29kb.js"></script>
<!-- <script src="./house/cannon.min.js"></script> -->

<script src="./house/cubedata.js"></script> <!-- æ¨¡å‹æ•°æ® -->
<script src="./house/makegroundmvp.js"></script> <!-- åœ°é¢å’Œäººç‰©åˆå§‹åŒ– -->
<script src="./house/newmvp.js"></script> <!-- æ–°è§’è‰² -->
<script src="./house/startbuild.js"></script> <!-- å¼€å§‹å»ºé€ çš„åˆå§‹åŒ–å‡†å¤‡ -->
<script src="./house/logicbuild.js"></script> <!-- å»ºé€ é€»è¾‘å·¥å…·å‡½æ•° -->
<script src="./house/logicdata.js"></script> <!-- å»ºé€ é€»è¾‘ -->
<script src="./house/booksystem.js"></script> <!-- ä¹¦ç³»ç»Ÿ -->
<script src="./house/booksystemtool.js"></script> <!-- ä¹¦ç³»ç»Ÿçš„å·¥å…·å‡½æ•° -->
<script src="./house/dataprocess.js"></script> <!-- æ•°æ®å¤„ç† -->
<script src="./house/vk.js"></script> <!-- vkå¤„ç† -->

<script type="module" src="./house/import.js"></script> <!-- å¯¼å…¥æ’ä»¶ -->
<script type="module" src="./house/index.js" ></script>

<!---- [ ä¸‹é¢æ˜¯æµ‹è¯• ] --->

<style>
    body{margin: 0;}
    #someCtrl {
        position: fixed;
        top: 25px;
        opacity: 0.5;
        right: 50px;
    }
    #someCtrl button {
        width: 160px;
        height: 50px;
        font-size: 20px;
    }
    .info-modal {
        position: fixed;
        background-color: #ffffff6b;
        backdrop-filter: blur(7px);
        right: 30px;
        top: 30px;
        width: 500px;
        max-width: calc(100vw - 80px);
        height: 80vh;
        z-index: 1;
        overflow: auto;
        padding: 1em;
    }

    /* æ„Ÿè°¢éƒ¨åˆ†ï¼Œ<a> æ— ä¸‹åˆ’çº¿ */
    #stargazers a {
        text-decoration: none;
    }

    /* ç§»åŠ¨ç«¯çš„æ§åˆ¶ */
    .pad{
        background: transparent;
        width: 150px;
        height: 150px;
        position: fixed;
        z-index: 1;
        bottom: 80px;
        right: 80px;
        user-select: none;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(3, 1fr);
        gap: 6px;
        padding: 6px;
        box-sizing: border-box;
        touch-action: none;
    }
    .cell{
        border: none;
        background: #ffffff82;
        font-size: 22px;
        font-weight: 600;
        display:flex;
        align-items:center;
        justify-content:center;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
    }
    .cell:active{
        color: #0ff; /* æŒ‰ä¸‹æ—¶é«˜äº® */
        transform: scale(1.1);
    }
    .pad{display:none}
    @media (max-width:820px) and (hover: none) and (pointer: coarse) {
        .pad{display:grid;}
    }
</style>
<div id="someCtrl">
    <button id="btn01" style="width: 105px;">æ›´å¤šä¿¡æ¯</button>
</div>
<div id="mCtrl" class="pad">
  <button class="cell" id="turnL">â†</button>
  <button class="cell" id="goF">å‰</button>
  <button class="cell" id="turnR">â†’</button>

  <button class="cell" id="goL">å·¦</button>
  <button class="cell" id="goJump">è¹¦</button>
  <button class="cell" id="goR">å³</button>

  <button class="cell" id="lookUp">ä¸Š</button>
  <button class="cell" id="goB">å</button>
  <button class="cell" id="lookDn">ä¸‹</button>
</div>
<div class="info-modal" id="myinfoModal" hidden>
    <div>
    <button id="closeBtn">å…³é—­</button>

    <a href="//github.com/kohunglee/openworld-js" target="_blank">
        <img src="https://img.shields.io/github/stars/kohunglee/openworld-js?style=social" 
            alt="GitHub Repo stars" 
            style="width: 110px;height: 30px;margin-bottom: -10px;">
    </a>
    
    <hr>

    <div>
        <h3>å¿«æ·æ“ä½œ</h3>
        <button id="goOPOS">åˆ°åŸç‚¹</button>
        <button id="goHall">åˆ°å¤§å…</button>
         <hr>
    </div>

    <div>
        <h3></h3>
        å½“å‰åœ¨çº¿äººæ•°ï¼š<span id="onlineCount">1</span>
        <ul id="frendPosInfo"></ul>
        <hr>
    </div>

    <div>
        <h3>ç®€ä»‹</h3>
        <p>è¿™æ˜¯ä¸€ä¸ªç”± webgl å¼€å‘çš„ js åº“ openworld-js çš„æµ‹è¯•æ¼”ç¤ºç¨‹åºã€‚è¯¥åº“ä»åœ¨å¼€å‘ï¼Œç›®çš„æ˜¯æˆä¸ºä¸€ä¸ª 40kb çš„æå°ä½“ç§¯æ¸¸æˆå¼•æ“ï¼Œé‡Œé¢åŒ…å«äº†ä¸‰ç»´æ¸²æŸ“å’Œç‰©ç†å¼•æ“ã€‚</p>
        <p>å¦‚æ‚¨æ‰€è§ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»ä¼¼äºå›¾ä¹¦é¦†çš„å»ºç­‘ï¼Œé‡Œé¢æ”¾ç½®äº† 30ä¸‡ æœ¬ã€Œä¹¦ã€ï¼Œç›®å‰è¿™äº›ã€Œä¹¦ã€è¿˜æ²¡æœ‰è¢«å¡«å……ï¼Œæœªæ¥å‡ æ—¥ä¼šè¢«å¡«å……ä¸€ä¸‹ï¼ˆä¸ä¸€å®šæ˜¯ä¹¦ï¼‰ã€‚å†…ç½®äº† websocket å¯ä»¥å®ç°è®©æˆ‘ä»¬å¤šäººåœ¨çº¿äº’åŠ¨ï¼Œç›¸äº’æ¸¸ç©åœ¨å»ºç­‘ä¹‹é—´ã€‚éå¸¸çš„æœ‰è¶£ï¼</p>
        <hr>
    </div>

    <div>
        <h3>æ“ä½œæ–¹å¼</h3>
        <h4>ç”µè„‘</h4>
        <ul>
            <li>W A S D,æˆ–é”®ç›˜ä¸Šçš„æ–¹å‘é”®ï¼Œæ§åˆ¶ ä¸»è§’ å‰åå·¦å³ç§»åŠ¨ï¼Œè€ç”Ÿå¸¸è°ˆ...</li>
            <li>é¼ æ ‡å•å‡»ç”»é¢åï¼Œæ»‘åŠ¨ï¼Œå¯ä»¥æ§åˆ¶è§†è§’ã€‚</li>
            <li>ç©ºæ ¼ æˆ– E ä¸ºè·³è·ƒï¼ˆæ¨èä½¿ç”¨ E ï¼Œæ•²é”®ç›˜å£°éŸ³æ›´å°ï¼‰ã€‚</li>
            <li>shift æˆ– Q ä¸ºå¿«é€Ÿè·‘ï¼ˆæ¨èä½¿ç”¨ Qï¼Œå°æ‹‡æŒ‡ä¸ä¼šé…¸ç–¼ ğŸ˜‚ï¼‰ã€‚</li>
            <li>F é”®ï¼Œfrozen ï¼Œå†»ç»“åˆ°ç©ºä¸­ã€‚</li>
            <li>V é”®ï¼Œå¯ä»¥åˆ‡æ¢è§†è§’ï¼Œè¿œæ™¯ã€è¿‘æ™¯ã€ç¬¬ä¸€äººç§°è§†è§’ã€‚</li>
            <li>å•å‡»åï¼Œåœ†ç‚¹å¯ä»¥é€‰æ‹©ç‰©ä½“ï¼Œå·¦ä¸Šè§’æ˜¯ç‰©ä½“çš„æ•°å­— IDï¼Œç›®å‰å°šåœ¨æµ‹è¯•ï¼Œä¾¿äºå»ºæ¨¡ï¼Œè¯·ã€é€€å‡ºã€‘æ­¤æ¨¡å¼ã€‚</li>
        </ul>
        <h4>ç§»åŠ¨è®¾å¤‡</h4>
        <p>åˆæ­¥æ”¯æŒï¼Œå°šåœ¨æµ‹è¯•ï¼Œæ¬¢è¿æ¢ç´¢...</p>
        <hr>
    </div>

    <div>
        <h3>æ›´æ–°è®°å½•</h3>
        <ul>
            <li>2025/10/22 - æ·»åŠ äº†ã€æ›´å¤šä¿¡æ¯ã€‘ï¼Œä¼˜åŒ–äº†å¤šäººåœ¨çº¿ï¼Œå¢åŠ äº†ç§»åŠ¨ç«¯çš„åˆæ­¥æ§ä»¶</li>
        </ul>
        <hr>
    </div>

    <div>
        <h3>æ³¨æ„äº‹é¡¹</h3>
        <ul>
            <li>æœ¬é¡¹ç›®ä»åœ¨å¼€å‘ä¸­ï¼ŒåŠŸèƒ½ä¸å®Œå–„ï¼Œå¯èƒ½å­˜åœ¨ BUG ï¼Œè¯·å¤šåŒ…æ¶µ</li>
            <li>å»ºè®®ä½¿ç”¨è¾ƒæ–°çš„æµè§ˆå™¨ï¼Œå¦‚ Chromeã€Firefox ç­‰ï¼Œä»¥è·å¾—æ›´å¥½çš„ä½“éªŒ</li>
            <li>å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥åœ¨ GitHub ä»“åº“ä¸­æäº¤ issue æˆ– <a href="//www.ccgxk.com">è”ç³»ä½œè€…</a> </li>
        </ul>
        <hr>
    </div>

    <div id="stargazers">
        <h3>Star</h3>
        æ„Ÿè°¢åœ¨ github ä¸Š star äº† <a href="//github.com/kohunglee/openworld-js" target="_blank"> æœ¬ä»“åº“ </a> çš„æœ‹å‹ä»¬ï¼š<br><br>
            <a href="https://github.com/yangxinyu1226" title="yangxinyu1226" target="_blank">
            <img src="https://avatars.githubusercontent.com/u/206335988?v=4" width="32" height="32" style="border-radius:50%;margin:2px">
        </a><a href="https://github.com/liukjx" title="liukjx" target="_blank">
            <img src="https://avatars.githubusercontent.com/u/33191606?v=4" width="32" height="32" style="border-radius:50%;margin:2px">
        </a><a href="https://github.com/kohunglee" title="kohunglee" target="_blank">
            <img src="https://avatars.githubusercontent.com/u/33373536?v=4" width="32" height="32" style="border-radius:50%;margin:2px">
        </a><a href="https://github.com/skylee03" title="skylee03" target="_blank">
            <img src="https://avatars.githubusercontent.com/u/24489025?v=4" width="32" height="32" style="border-radius:50%;margin:2px">
        </a><a href="https://github.com/kong1383068" title="kong1383068" target="_blank">
            <img src="https://avatars.githubusercontent.com/u/24849322?v=4" width="32" height="32" style="border-radius:50%;margin:2px">
        </a><a href="https://github.com/askshjcn" title="askshjcn" target="_blank">
            <img src="https://avatars.githubusercontent.com/u/21169734?v=4" width="32" height="32" style="border-radius:50%;margin:2px">
        </a>
    </div>

    <hr>
    <button id="closeBtn02">å…³é—­</button>
    </div>
</div>
<script>

    // ç¨‹åºè¯´æ˜
    btn01.addEventListener('mousedown', function(event) {
        document.getElementById('myinfoModal').hidden = false;
    });

    // å…³é—­ ã€ç¨‹åºè¯´æ˜ã€‘æ¨¡æ€æ¡†
    document.getElementById('closeBtn').addEventListener('click', function() {
        document.getElementById('myinfoModal').hidden = true;
    });

    // å…³é—­ ã€ç¨‹åºè¯´æ˜ã€‘æ¨¡æ€æ¡† 02 
    document.getElementById('closeBtn02').addEventListener('click', function() {
        document.getElementById('myinfoModal').hidden = true;
    });

    // åˆ°åŸç‚¹
    document.getElementById('goOPOS').addEventListener('click', function() {
        k.mainVPlayer.body.position.x = 7.6;
        k.mainVPlayer.body.position.y = 10;
        k.mainVPlayer.body.position.z = 16.5;
        k.keys.turnRight = 0;
    });

    // åˆ°å¤§å…
    document.getElementById('goHall').addEventListener('click', function() {
        k.mainVPlayer.body.position.x = 31;
        k.mainVPlayer.body.position.y = 10;
        k.mainVPlayer.body.position.z = -31;
        k.keys.turnRight = 90;
    });

    // ç§»åŠ¨ç«¯
    const turnNum = 0.5;  // æ—‹è½¬æ—¶çš„å•ä½è§’åº¦
    const stepNum = 2;  // ç§»åŠ¨æ—¶çš„å•ä½è·ç¦»
    // å‰
    const goF = document.getElementById('goF');
    goF.onmousedown = goF.ontouchstart = () => {
        k.keys.viewForward = 1;
    };
    goF.onmouseup = goF.ontouchend = () => {
        k.keys.viewForward = 0;
    };
    // å
    const goB = document.getElementById('goB');
    goB.onmousedown = goB.ontouchstart = () => {
        k.keys.viewBackward = 1;
    };
    goB.onmouseup = goB.ontouchend = () => {
        k.keys.viewBackward = 0;
    };
    // å·¦è½¬
    const turnL = document.getElementById('turnL');
    let timeturnL = null;
    turnL.onmousedown = turnL.ontouchstart = () => {
        if (timeturnL) return;
        timeturnL = setInterval(() => {
            k.keys.turnRight+=turnNum;
        }, 10); // æ¯ 100ms æ‰§è¡Œä¸€æ¬¡
    };
    turnL.onmouseup = turnL.ontouchend = () => {
        clearInterval(timeturnL);
        timeturnL = null;
    };
    // å³è½¬
    const turnR = document.getElementById('turnR');
    let timeturnR = null;
    turnR.onmousedown = turnR.ontouchstart = () => {
        if (timeturnR) return;
        timeturnR = setInterval(() => {
            k.keys.turnRight-=turnNum;
        }, 10); // æ¯ 100ms æ‰§è¡Œä¸€æ¬¡
    }
    turnR.onmouseup = turnR.ontouchend = () => {
        clearInterval(timeturnR);
        timeturnR = null;
    };
    // å·¦ç§»
    const goL = document.getElementById('goL');
    goL.onmousedown = goL.ontouchstart = () => {
        k.keys.viewLeft = 1;
    };
    goL.onmouseup = goL.ontouchend = () => {
        k.keys.viewLeft = 0;
    }
    // å³ç§»
    const goR = document.getElementById('goR');
    goR.onmousedown = goR.ontouchstart = () => {
        k.keys.viewRight = 1;
    };
    goR.onmouseup = goR.ontouchend = () => {
        k.keys.viewRight = 0;
    }
    // è¹¦
    const goJump = document.getElementById('goJump');
    goJump.onmousedown = goJump.ontouchstart = () => {
        k.mainVPlayer.body.velocity.y = k.jumpYVel;
    };
    // æŠ¬å¤´
    const lookUp = document.getElementById('lookUp');
    let timelookUp = null;
    lookUp.onmousedown = lookUp.ontouchstart = () => {
        if (timelookUp) return;
        timelookUp = setInterval(() => {
            k.keys.turnUp+=turnNum;
        }, 10); // æ¯ 100ms æ‰§è¡Œä¸€æ¬¡
    };
    lookUp.onmouseup = lookUp.ontouchend = () => {
        clearInterval(timelookUp);
        timelookUp = null;
    };
    // ä½å¤´
    const lookDn = document.getElementById('lookDn');
    let timelookDn = null;
    lookDn.onmousedown = lookDn.ontouchstart = () => {
        if (timelookDn) return;
        timelookDn = setInterval(() => {
            k.keys.turnUp-=turnNum;
        }, 10); // æ¯ 100ms æ‰§è¡Œä¸€æ¬¡
    };
    lookDn.onmouseup = lookDn.ontouchend = () => {
        clearInterval(timelookDn);
        timelookDn = null;
    };
</script>
